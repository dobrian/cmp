<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://dobrian.github.io/cmp/static/css/cmp.css" />
    <title>Computer Music Programming</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp">Computer Music Programming</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp/examples.html">Examples</a>
        </li>
      </ul>
    </nav>
    <div class="container">
      <h1 id="computer-music-programming">List of Examples</h1>
      <hr />
      <h2><a name="max">Max Examples</a></h2>
      <p>
      The largest single collection of Max examples is the <a href="http://music.arts.uci.edu/dobrian/maxcookbook/">Max Cookbook</a>. You can find specific examples there by title or by keyword search.
      </p>
      <p><strong>[Each image below is linked to a file of JSON code containing the actual Max patch.<br />
        Right-click on an image to download the .maxpat file directly to disk, which you can then open in Max.]</strong>
      </p>
      <p>
        <a name="Ex01"><b>Example 1</b></a>: Fade-in and fade-out
      </p>
      <p>
        <a href="examples/max/patches/fadeinfadeoutdemo.maxpat"><img src="examples/max/images/fadeinfadeoutdemo.png" width=467 height=484 alt="Example 1" border=0></a>
      </p>
      <p>
      This shows the use of linear interpolation from one amplitude to another to create a smooth fade-in or fade-out. The <b>line~</b> object expects to receive a ramp time in milliseconds in its right inlet, and then a destination value in its left inlet. (It can also receive those two numbers as a two-item list, &lt;destination value&gt;&lt;ramp time&gt;, in its left inlet.) Its output signal will then change linearly from its current value to its new destination value in the specified amount of time. Once it arrives at the destination value, its output signal stays constant at the new value.
      </p>
      <p>
      Because the fade-out takes a non-zero amount of time, it's necessary to delay stopping the sound file until the fade-out has taken place. So, whereas we can start the fade-in at the same time as we start the sound file, we need to wait for the fade-out to finish before we stop the file. So, we look for the off message (0), using a <b>select</b> object, which will send out a <i>bang</i> when it receives a match, and we then delay that bang with a <b>delay</b> object until the fade-out is done, then the <i>bang</i> triggers the message <i>0</i> to stop the <b>sfplay~</b> object.
      </p>
      <p>
        <a name="Ex02"><b>Example 2</b></a>: Vibrato by means of frequency modulation
      </p>
      <p>
        <a href="examples/max/patches/modulationdemo.maxpat"><img src="examples/max/images/modulationdemo.png" width=899 height=483 alt="Example 2" border=0></a>
      </p>
      <p>
      The <b>cycle~</b> object is an oscillator that produces a sinusoidal tone at any specified frequency. At an audio frequency we can listen to it, and at a sub-audio frequency we can use it as a low-frequency oscillator (LFO) to modulate some parameter of a sound. This patch demonstrates frequency modulation to create a vibrato effect. Try changing the different number boxes until you have a good experience of how each parameter affects the sound, especially the rate and depth of the frequency modulation caused by the modulating oscillator. Try some extreme values to get extreme effects.
      </p>
      <p>
      Because the fade-out takes a non-zero amount of time, it's necessary to delay stopping the sound file until the fade-out has taken place. So, whereas we can start the fade-in at the same time as we start the sound file, we need to wait for the fade-out to finish before we stop the file. So, we look for the off message (<i>0</i>), using a <b>select</b> object, which will send out a <i>bang</i> when it receives a match, and we then delay that bang with a <b>delay</b> object until the fade-out is done, then the <i>bang</i> triggers the message <i>0</i> to stop the <b>sfplay~</b> object.
      </p>
      <p>
        <a name="Ex03"><b>Example 3</b></a>: MIDI Keyboard Example
      </p>
      <p>
        <a href="examples/max/patches/midikeyboard.maxpat"><img src="examples/max/images/midikeyboard.png" class="img-fluid"></a>
      </p>
      <p>
        <a name="Ex04"><b>Example 4</b></a>: Mouse Theremin
      </p>
      <p>
        <a href="examples/max/patches/mousetheremin.maxpat"><img src="examples/max/images/mousetheremin.png" class="img-fluid"></a>
      </p>
      <p>
        <a name="Ex05"><b>Example 5</b></a>: Saw Synth Demo
      </p>
      <p>
        <a href="examples/max/patches/sawsynthdemo.maxpat"><img src="examples/max/images/sawsynthdemo.png" class="img-fluid"></a>
      </p>
      <p>
        <a name="Ex06"><b>Example 6</b></a>: Schedule a future event
      </p>
      <p>
        <a href="examples/max/patches/schedulefutureevent.maxpat"><img src="examples/max/images/schedulefutureevent.png" width=544 height=306 alt="Example 6" border=0></a>
      </p>
      <p>
        Timing is very important in music. The fundamental way to ensure precise timing of events is to use a scheduler. A schedule is a list of time-tagged events to be executed at specific times in the future. That schedule must be consulted constantly at regular intervals (as often as possible, e.g., every millisecond) to see if any item on the list has a time tag that is less than or equal to the current time; if so, that event should be enacted.
      </p>
      <p>
        Max has a master scheduler constantly running behind the scenes, and has various objects that allow you to post events on the schedule. The simplest of all of those is the <b>delay</b> object. When <b>delay</b> receives a <i>bang</i> in its left inlet, it schedules that <i>bang</i> to be sent out its outlet after a delay of a certain number of milliseconds, which has been specified in its right inlet. (Alternatively, if <b>delay</b> receives an <i>int</i> or a <i>float</i> in its left inlet, it uses that number to set its delay time, overwriting whatever number was previously set as the delay time, and schedules a <i>bang</i> to be sent out after that number of milliseconds has elapsed.)
      </p>
      <p>
        The <b>delay</b> object can schedule only one <i>bang</i> at a time. If another <i>bang</i>, <i>int</i>, or <i>float</i> is received in its left inlet before the previously-scheduled <i>bang</i> has been sent out, the previously-scheduled <i>bang</i> will be pre-empted and the new <i>bang</i> will be scheduled instead. The message <i>stop</i> in the left inlet cancels any currently-scheduled <i>bang</i>. If the delay time in the right inlet is changed while a <i>bang</i> is scheduled, that doesn't change the timing of the existing scheduled <i>bang</i>; the new delay time only affects subsequently-scheduled <i>bang</i>s.
      </p>
      <p>
        In this example, we use a bass drum sound and a snare drum sound as two stand-ins for the idea of "an event", but in fact an event can be any Max message, or combination of messages, even turning on or off other entire processes. The delay time might be only a few milliseconds, to make two things happen in rapid precisely-timed succession, or it could be a much longer time (though still expressed in terms of milliseconds) such as several seconds, minutes, or even hours.
      </p>
      <p>
        Although it's not demonstrated in this example, it's also possible to specify the delay time in <a href="https://docs.cycling74.com/max7/vignettes/maxtime_syntax">tempo-relative time units</a>, such as <i>4n</i> for a quarter note, based on the current tempo of the Max <a href="https://docs.cycling74.com/max7/maxobject/transport">transport</a>, but in that case <b>delay</b> will only work when the transport is on.
      </p>
      <p>
        The Max <b>delay</b> object is comparable to the <code>setTimeout()</code> method in JavaScript. When using JavaScript within a Max <b>js</b> object, the <code>setTimeout()</code> method is not available; the nearest equivalent is the <code>schedule()</code> method of <a href="https://docs.cycling74.com/max7/vignettes/jstaskobject">the Task() object</a>, but that will run in a low-priority thread of Max, not in the high-priority scheduler as Max's <b>delay</b> object does.
      </p>
      <p>
        <a name="Ex07"><b>Example 7</b></a>: DIY ring buffer
      </p>
      <p>
        <a href="examples/max/patches/ringbufferdemo.maxpat"><img src="examples/max/images/ringbufferdemo.png" width=741 height=545 alt="Example 7" border=0></a>
      </p>
      <p>
        For time-delayed audio, we need to create what's called a "<a href="https://en.wikipedia.org/wiki/Circular_buffer">circular buffer</a>" or a "ring buffer", an array of samples to which we record continuously in a loop, and which we can then use always to access the most recently recorded sound from the past.
      </p>
      <p>
        The MSP object <b>delay~</b> does exactly that. And another pair of objects&mdash;<b>tapin~</b> and <b>tapout~</b> does the same thing, but with a minimum delay of one signal vector so that you can even feed the delayed sound back into the delay loop. However, in this example, we build and access a ring buffer ourselves, just to demonstrate inner workings of the process in a little more detail.
      </p>
      <p>
        The <b>buffer~</b> object creates an array in RAM for storing sound and accessing it in a variety of ways. Here we create a one-second buffer, and we use a sample counter (the <b>count~</b> object) to put each sample of the incoming sound (from <b>adc~</b>) into that array, using the <b>poke~</b> object to access individual sample locations in the array. At the same time, we can use that same sample counter, which is always pointing to the location of the current time in the array, to calculate the signal some amount of time (some number of samples) in the past. If the current time in samples minus the delay time in samples is less than 0, we need to wrap the calculated sample location back into the array (by adding the number of samples in the array); that's what the <b>pong~</b> object does for us.
      </p>
      <p>
        You can try this out yourself, but beware of the possibility of feedback, since this patch sends the incoming sound from <b>adc~</b>, with some delay, right back out via the <b>dac~</b>.
      </p>
      <p>
        <a name="Ex08"><b>Example 8</b></a>: Algorithmic Demo with Phasor
      </p>
      <p>
        <a href="examples/max/patches/algorithmicdemowithphasor.maxpat"><img src="examples/max/images/algorithmicdemowithphasor.png" width=544 height=306 alt="Example 6" border=0></a>
      </p>

      <hr />

      <h2><a name="webaudio">WebAudio Examples</a></h2>

      <p>
        <a name="Ex01js"><b>Example 1</b></a>: Synthesizer with vibrato
      </p>

      <p>Here is a basic synthesizer in Web Audio, designed by Chris, with a sawtooth oscillator, a simple attack-release amplitude envelope, and sinusoidal vibrato by means of frequency modulation with an LFO. The notes are played by keys of the computer keyboard. MIDI velocity is simulated by setting a note-on velocity value to control the notes' peak amplitude. The rate and depth of the vibrato can also be set by the user.
      </p>

      <p>
        <a href="examples/javascript/vibratosynth.html">Synthesizer with vibrato</a>
      </p>

      <p>
        There are lots of explanatory comments in the <a href="examples/javascript/vibratosynth.js">vibratosynth.js</a> file.
      </p>
    </div>
  </body>
</html>
