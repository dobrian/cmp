<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
    <link rel="stylesheet" href="../../static/css/cmp.css">
    <title>LFOs</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp">Computer Music Programming</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp/topics.html">Topics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="0.building-a-synthesizer.html">Building a Synthesizer with Web Audio API</a>
        </li>
      </ul>
    </nav>
    <div class="container">
      <h1>LFOs</h1>

      <div id="video-script" class="row">
        <div id="video" class="col">
          <video controls
                 src="2.lfos.mp4"
                 width="100%"
                 height="100%"
                 >
        </div>
        <div id="script" class="col">
          <button id="toggle-script" type="button" class="btn btn-primary">Show/Hide Text</button>
          <div id="script-text" style="display: none; overflow-y: scroll">



<h3>Vibrato</h3>

<p>Let's create a vibrato effect, which is a periodic wobble in pitch.  We start
with an oscillator that's producing a constant pitch.  To add vibrato, we need
a secondary oscillator, called a "modulator", which changes the pitch of the
first oscillator.  Since this second oscillator tends to run at a low
frequency—usually below the threshold of hearing at 20 Hz or fewer—you'll
sometimes hear the modulator referred to as a "low frequency oscillator".</p>

<pre><code>const audioCtx = new AudioContext();

const oscillator = audioCtx.createOscillator();
oscillator.frequency.value = 220;
oscillator.type = "sawtooth";
const oscillatorGain = audioCtx.createGain();
oscillatorGain.gain.value = 0.1;
oscillator.connect(oscillatorGain);
oscillatorGain.connect(audioCtx.destination);

const modulator = audioCtx.createOscillator();
modulator.frequency.value = 1;
const modulatorGain = audioCtx.createGain();
modulatorGain.gain.value = 100;
modulator.connect(modulatorGain);
modulatorGain.connect(oscillator.frequency); // try switching to oscillator.detune

oscillator.start();
modulator.start();
</code></pre>

<p>Create a modulator just like you would any other oscillator.  The frequency
should be small enough that you can hear the vibrato effect; this example uses
a modulator frequency of just 1 Hz.  Then, you can hook up the modulator to a
<code>GainNode</code>.  The value of the <code>GainNode</code>'s <code>.gain</code> determines how wide the
wobble is; this example features a very exaggerated vibrato of 100 Hz.</p>

<p>Next, we connect the modulator node to its gain, then its gain node to the
oscillator's frequency.  Lastly, we start the modulator.  Let's hear what this
example sounds like!</p>

<p>Since there are two ways to adjust the pitch of an oscillator—frequency and
detune—there are therefore two ways the modulator can create vibrato: one by
hooking up the modulator to the <code>.frequency</code> property, and one by hooking up
the modulator the <code>.detune</code> property.  Let's see what happens if we hook up our
modulator to <code>.detune</code> instead of <code>frequency</code>.</p>

<p>You'll hear that the wobble is much smaller.  The reason is that while
<code>ferquency</code> is measured in Hz, <code>.detune</code> is measured in <strong>cents</strong>.  Since cents
are almost always smaller than Hz, the second wobble is therefore smaller than
the first.</p>

<h3>Tremolo</h3>

<p>Another effect is "tremolo", which is a periodic wobble in volume.  To create a
tremolo, we need to have our modulator alter the amplitude of the oscillator.
We can access the amplitude of the oscillator via the oscillator <code>GainNode</code>'s
<code>.gain</code> property.  Make sure also to lower the modulator's gain to 1—otherwise
the volume will be incredibly loud!</p>

<pre><code>const audioCtx = new AudioContext();

const oscillator = audioCtx.createOscillator();
oscillator.frequency.value = 220;
oscillator.type = "sawtooth";
const oscillatorGain = audioCtx.createGain();
oscillatorGain.gain.value = 0.1;
oscillator.connect(oscillatorGain);
oscillatorGain.connect(audioCtx.destination);

const modulator = audioCtx.createOscillator();
modulator.frequency.value = 1;
const modulatorGain = audioCtx.createGain();
modulatorGain.gain.value = 1;
modulator.connect(modulatorGain);
modulatorGain.connect(oscillatorGain.gain);

oscillator.start();
modulator.start();
</code></pre>

<p>You'll notice the sound ducking in and out; however, it's doing so twice a
second, not once a second.  Why is that?  The reason is that the oscillator's
gain reaches maximum volume when the modulator wave is at either 1 <em>or</em> -1; the
oscillator is silent whenever the modulator wave is at 0.  Since there are two
0-crossings in one period of a sine wave, we are actually getting two amplitude
pulses per second, not one.</p>


          </div>
        </div>
      </div>


<h2>Downloads</h2>

<p>Download the files used in the above examples by right-clicking the links, and
then selecting "Save Link As...".</p>

<ul>
<li><a href="vibrato.html">vibrato.html</a></li>
<li><a href="vibrato.js">vibrato.js</a></li>
<li><a href="tremolo.html">tremolo.html</a></li>
<li><a href="tremolo.js">tremolo.js</a></li>
</ul>

<h2>Vocabulary</h2>

<ul>
<li>LFO</li>
<li>tremolo</li>
<li>vibrato</li>
</ul>

<h2>Self-Study</h2>

<ol>
<li>Try playing around with different waveforms for the modulator.  What happens
if you change its <code>.type</code> property to <code>"square"</code> or <code>"sawtooth"</code>?</li>
<li>Use two LFOs with different parameters to create a complex vibrato or
tremolo.  Hint: try using one LFO to change the frequency or gain of the
second LFO.</li>
<li>In the above explanation, we only run vibrato and tremolo effects at low
frequencies.  (Hence, "low frequency oscillator".)  What happens when you
run these effects at higher, audio-rate frequencies?  Hint: look up "frequency
modulation" and "amplitude modulation".</li>
</ol>


    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script>
    //$('pre').addClass("javascript");
    hljs.initHighlightingOnLoad();
    </script>
    <script src="../../static/js/cmp.js"></script>
  </body>
</html>
