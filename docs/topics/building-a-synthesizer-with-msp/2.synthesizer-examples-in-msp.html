<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">-->
    <link rel="stylesheet" href="../../static/css/cmp.css">
    <title>Synthesizer Examples in MSP</title>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp">Computer Music Programming</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../topics.html">Topics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="0.index.html">Building a Synthesizer with MSP</a>
        </li>
      </ul>
    </nav>

    <div class="container">

    <h1>Synthesizer Examples in MSP</h1>

    <!--<hr width="50%"/>-->
    <p>
      You can surmise some of the ways in which the example on the previous lesson is inadequate:
      <ol>
        <li>It doesn't properly account for the possibility that the user might press two MIDI keys at once (or have unintentional overlap while playing a melody, thus releasing key A after playing key B).</li>
        <li>The sound generator&mdash;a sawtooth oscillator&mdash;is not very interesting. Many more interesting sounds are possible. At the least, this sound may need some filtering, vibrato, etc. </li>
        <li>It turns the sound on and off instantaneously. Some sort of amplitude envelope is needed to give the sound a more interesting shape.</li>
        <li>It doesn't implement pitchbend or modulation.</li>
      </ol>
    </p>

    <p>
      Here is a video and some other <a href="http://music.arts.uci.edu/dobrian/maxcookbook/">Max Cookbook</a> examples that will put you on the path to a more effective synth:
    </p>

    <div id="video-script1" class="row">
      <div id="video" class="col">
        <video controls
               src="2.sawtooth_with_keyboard_tutorial.mp4"
               width="100%"
               height="100%"
               >
      </div>
      <div id="script1" class="col">
        <button id="toggle-script" type="button" class="btn btn-primary">Show/Hide Text</button>
        <div id="script-text" style="display: none; overflow-y: scroll">

          <h3>Controlling a sawtooth with the keyboard</h3>

          <p>
            This is a video on controlling a sawtooth with the computer keyboard in Max. This project will have three components: the oscillator (a sawtooth wave), the keyboard control implementation, and an amplitude envelope. For the oscillator, we can use the saw~ object. And since we probably want to control the volume, we'll use live.gain~, while setting it for one channel, and the orientation to horizontal. As with most DSP projects, we might need and ezdac~ too! For the keyboard control implementation, we will rely on the key object. The key object sends out an ASCII code of the Key pressed. So, if I lock the patch, and start pushing keys on my keyboard, you'll see the ASCII code. For our implementation we'll use the row of keys from A to J, and some of the keys from the row above, to serve as our keyboard control. Now, we can note down these numbers on a piece of paper but, since we are in Max (and you are eager to improve your programming skills), I'm going to use Max objects. I'm going to use zl.group, and connect it to a "t l l" (trigger list list), which will send the list to a message - that will hold our results -, and back to zl.group. This will receive its values from a "t b i" (trigger bang integer) which will send the integer and bang the zl.group. Also, let's add here a "zlclear" message so that we can clear our memory before we begin. I'm going to press the A key, W, S, E, D, F, T, G, Y, H, U, J, and also K. After this, we can delete the patch cord, for we already have what we need. Let's copy the content of the message box and paste in on a select object. Now, I could create message boxes to do whatever I need to do after each of these options is triggered, but I'm going to use a more clever way to do this. I'm going to use the funnel object. I set the argument to 13, because we have 13 options. Then, I need to connect each option to the inlets. The way funnel works is that it sends out a list composed of the inlet number where it has received a message, and the message itself. It works something like this. So, what we want is this first part of the message. We can retrieve just that using a "$1" message. Since we are doing this, we probably want to have the A key to be sending out number "60", as in MIDI note number 60. For that, since we are starting in 0 up to until 11 - or 12, with the K key -, we can use the + object, and write as "+ 60". Now, since we are doing all this, we might as well implement a way to change the octave. Let's use the Z and X key, which is 122 and 120. Let's add those two options to the select object. And we will rely on incdec object, which will increase a number and decrease a number. This object receives the "inc" message and the "dec" messages, that we can connect to the options on the select object. In turn, we will connect these message boxes to the incdec object. The way it works is that it sends out a number like this: when I press the Z key it will low the number, and when I press the X key it will increase the number. Again, because we are dealing with octaves, we need to multiply that number by 12. And that will serve as an offset; so we can use another + object to combine the "+ 60" and "* 12" objects. Now, this is a MIDI note number and the saw~ object is expecting frequency. Fortunately, there is an object to help us solve this problem - the mtof object. Let's give it a try. Cool! Let's build the amplitude envelope section now. We will use the function object and set the domain to 1000 - as in 1000 milliseconds for the duration of our envelope -, and the line~ object. Fortunately the second outlet of the function object sends out a message already formatted for the line object. And since we want this to interact with the saw~ signal, we need to insert a *~ object here. There is one last thing: when we send a number to the mtof, that will change the frequency, we need to trigger the function (which we also need to draw, by the way). The way this function is triggered is by receiving a bang. So, we can use between the last + object and the mtof object a "t i b" (trigger integer bang), so that when we send out an integer here, we can also trigger the function at the same time. Alright, that should work. And there you go!
          </p>
        </div>
      </div>
    </div>
<hr>

    <ul>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/very-simple-monophonic-midi-synthesizer">Very simple monophonic MIDI synthesizer</a><br>
        - nearly identical to the overly simple example, but with one small improvement</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/adsr-amplitude-envelope">ADSR amplitude envelope</a><br>
        - a classic way to make an amplitude envelope</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/how-adsr-object-works">How the adsr~ object works</a><br>
        - a further demonstration of the <strong>adsr~</strong> object</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/envelope-function-object">Envelope with the function object</a><br>
        - the function object generates line segment descriptions for the <strong>line~</strong> object, to design an amplitude envelope</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/using-sustain-point-function-object">Using a sustain point in a function object</a><br>
        - use most of an amplitude envelope, but wait for the note-off to complete it (similar effect to <strong>adsr~</strong>)</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/generate-classic-waveforms">Generate classic waveforms</a><br>
        - equivalents in Max for some basic waveforms found in most classic synthesizers</li>
      <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/frequency-modulation-sinusoidal-tones">Frequency modulation of sinusoidal tones</a><br>
        - add some pitch fluctuation to the sound (with video demo)</li>
    </ul>

    <div id="vocabulary">
      <h2>Vocabulary</h2>
      <ul>
        <li>ADSR envelope</li>
        <li>amplitude envelope</li>
        <li>monophonic</li>
        <li>sawtooth wave</li>
        <li>square wave</li>
        <li>triangle wave</li>
        <li>vibrato</li>
      </ul>
    </div>

    <div>
      <h2>Additional Resources</h2>
      <ul>
        <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/">Max Cookbook:</a> Useful and Instructive Programming Examples, by Christopher Dobrian</li>
        <li><a href="https://docs.cycling74.com/max8">Max 8 Documentation:</a> Also available from within <a href="../intro-to-max-and-msp/1.Getting-started-with-Max-and-MSP.html">Max itself</a>, here is the latest online version of Max documentaiton.</li>
        <li><a href="../keyboard-and-mouse-input-in-max/1.Keyboard-Input-in-Max.html">Keyboard Input in Max</a> is another lesson about keyboard input in Max.</li>
      </ul>
    </div>

  </div>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script>
  //$('pre').addClass("javascript");
  hljs.initHighlightingOnLoad();
  </script>-->
  <script src="../../static/js/cmp.js"></script>
</body>

</html>
