<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">-->
    <link rel="stylesheet" href="../../static/css/cmp.css">
    <title>Introduction to Linear Interpolation and Linear Mapping</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp">Computer Music Programming</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://dobrian.github.io/cmp/topics.html">Topics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="0.index.html">Linear Mapping and Interpolation</a>
        </li>
      </ul>
    </nav>
    <div class="container">

<h1>Introduction to Linear Interpolation and Linear Mapping</h1>

<hr/>

<p>
What does it mean to be partway from point A to point B? We could think of it in terms of being some fraction of the way there&mdash;one fourth of the way, halfway, three fourths of the way, and so on. When we're at point A, we could say we're "0" of the way to point B. When we arrive at point B, we're all the way there, which is to say "1" of the way there. Along the way we're some fraction of the way there between 0 and 1, and we can state the fraction as decimal, such as 0.25, 0.5, 0.75, etc. Our location between A and B can thus be stated as a number from 0 to 1.
</p>

<p>
What does it mean to be a fraction of the way between one number and another number? What's halfway from 0 to 100? That's pretty easy to calculate in your head, just intuitively, without even consciously doing any math. Halfway from 0 to 100 is 50. What's one quarter of the way from 0 to 100? 25, of course. Now, what's halfway from 10 to 48? A little harder, but not that hard: 29. What's three fifths of the way from 26.51 to 93.76? Hmm. Okay, now we might actually need to know what we're doing.
</p>

<p>
It's still not that hard really. We state the fraction as a decimal number, 0.6, we calculate the total distance between point A and point B as 93.76-26.51=67.25, we multiply that distance by 0.6 to get 40.35, and then we add that to the starting point A (26.51) to get 66.86. So, 66.86 is 0.6 of the way from 26.51 to 93.76.
</p>

<p>
To state that as a generic algebra equation, the value v at fraction f of the way between points a and b is calculated as <i>v=f(b-a)+a</i>. This is known as <a href="https://en.wikipedia.org/wiki/Linear_interpolation">linear interpolation</a> between two numbers. It's very useful for calculating intermediate values between two known values.
</p>

<p>
You could reverse that process to answer a question like, "What fraction of the way from 26.51 to 93.76 is 66.86?" In generic terms, "What fraction f of the way from a to b is v?" The formula for that is <i>f=(v-a)/(b-a)</i>. You can think of that as: the fraction f is "the distance v is from a" over "the distance b is from a".
</p>

<p>
Now let's suppose you're thinking of points A and B as two (x,y) coordinates on a 2D Cartesian plane. We'll call those points (x<sub>0</sub>,y<sub>0</sub>) and (x<sub>1</sub>,y<sub>1</sub>). The method of calculating a point that is some fraction f of the way from (x<sub>0</sub>,y<sub>0</sub>) to (x<sub>1</sub>,y<sub>1</sub>) is pretty similar. The x coordinate of the point will be <i>f(x<sub>1</sub>-x<sub>0</sub>)+x<sub>0</sub></i>, and the y coordinate will be <i>f(y<sub>1</sub>-y<sub>0</sub>)+y<sub>0</sub></i>.
</p>

<p>
This leads us to another useful concept: identifying a point that is within one range, and finding an analogous point within another range. If a value x lies within the range from x<sub>0</sub> to x<sub>1</sub> (i.e., lies some fraction of the way from x<sub>0</sub> to x<sub>1</sub>), what value y lies at the analogous position within the range from y<sub>0</sub> to y<sub>1</sub>?
</p>

<p>
<img src="./linearmapping.png" width="396" height="467" border="0">
</p>

<p>
This is known as linear mapping.<a href="#mappingfootnote">*</a> We're taking a phenomenon that occurs in one domain (the x axis) and "mapping" it onto another dimension (the y axis). If we know the range of possible x values is x<sub>min</sub> to x<sub>max</sub> and the range of possible y values is y<sub>min</sub> to y<sub>max</sub>, and we know the value of x, we can find the analogous value of y; y will be the same fraction of the way from y<sub>min</sub> to y<sub>max</sub> as x is from x<sub>min</sub> to x<sub>max</sub>. We can think of x as being the input (in a known range from x<sub>min</sub> to x<sub>max</sub>), and we want to calculate an output y (in a known range from y<sub>min</sub> to y<sub>max</sub>). We can do that with this equation:
</p>

<p>
y = y<sub>min</sub>+(y<sub>max</sub>-y<sub>min</sub>)(x-x<sub>min</sub>)/(x<sub>max</sub>-x<sub>min</sub>)
</p>

<p>
In the equation, the fraction we want to know is represented by (x-x<sub>min</sub>)/(x<sub>max</sub>-x<sub>min</sub>): "the distance x is from x<sub>min</sub>" over "the distance x<sub>max</sub> is from x<sub>min</sub>". We apply that fraction to "the distance y<sub>max</sub> is from y<sub>min</sub>" (y<sub>max</sub>-y<sub>min</sub>), and then add y<sub>min</sub> to that.
</p>

<p>
Here's a real-world musical example. Suppose we're designing a keyboard synthesizer, and we want to map the velocity with which a key is played to the loudness of the note it plays. The MIDI velocity value <i>v</i> we measure ranges from 1 to 127, and the amplitude range we want for the sound is from -60 to 0 decibels. So, we would use the formula:
</p>

<p>
<i>a = -60+(60)(v-1)/126</i>
</p>

<p>
What amplitude <i>a</i> would we use for a key played with a MIDI velocity <i>v</i> of 100? The mapping formula tells us -12.857 decibels.
</p>

<p>
In Max, for linear interpolation between values, there's an object called <b>line</b> for generating timed <i>int</i> or <i>float</i> messages interpolating linearly from one value to another, and there's a corresponding MSP object called <b>line~</b> that generates a linear signal from its current value to some new value in a given amount of time. Both objects allow you to specify several line segments by providing <i><destination><ramptime></i> pairs. For example, the message <i>1. 50  0. 200</i> to either <b>line</b> or <b>line~</b> means, &quot;Go from your current value to 1.0 in 50 ms, then go to 0.0 in 200 ms.&quot;
</p>

<p>
For linear mapping Max provides the <b>scale</b> object for messages, and the <b>scale~</b> object for MSP signals.
</p>

<p>
Here are some examples in Max/MSP:
<ul>
  <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/linear-interpolation-over-time">Linear interpolation over time</a><br/></li>
  <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/linear-interpolation-audio">Linear interpolation of audio</a><br/></li>
  <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/basic-linear-mapping">Basic linear mapping</a><br/></li>
  <li><a href="http://music.arts.uci.edu/dobrian/maxcookbook/linear-mapping-ranges">Linear mapping of ranges</a></li>
</ul>
</p>

<p>
<a name="mappingfootnote">*</a>The word "mapping" is used for a reason. It's the same sort of calculation a cartographer does. Imagine drawing a map of California. California is an enormous expanse of land, and we're going to map that as an analogous picture on a piece of paper. On our map, one point represents San Diego and another point represents Los Angeles. We know at what fraction of the distance from San Diego to Los Angeles the city of Irvine lies in the real world, so we can use that fraction to find the analogous point for Irvine on our piece of paper.
</p>

<hr width=50%/>

<p>
This page is by <a href=http://music.arts.uci.edu/dobrian/>Christopher Dobrian</a>, <a href="mailto:dobrian@uci.edu"><i>dobrian@uci.edu</i></a>.<br/>
Last modified March 30, 2019.
</p>


    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script>
    //$('pre').addClass("javascript");
    hljs.initHighlightingOnLoad();
    </script>-->
    <script src="../../static/js/cmp.js"></script>
  </body>
</html>
